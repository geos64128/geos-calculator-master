; **************************************; Program Name : calculator; GEOS File Type : Desk Accessory ; GEOS Structure : SEQUENTIAL; Load Address   : $5240; Init Address   : $5240;; Reassembled by Scott Hutter / xlar54; **************************************.if          Pass1.noeqin.noglbl.include geosSym.include geosMac.eqin.glbl.endif.psect;**********************************************screenColors == $851ecmdListen == $ffb1cmdUnList == $ffaesendSecL == $ff93sendSecT == $ff96outByte == $ffa8inpByte == $ffa5cmdTalk == $ffb4cmdUnTalk == $ffab;**********************************************DAStart:        lda #$52        sta r5H        lda #$d0        sta r5L        lda #$00        sta r6L        jsr l5B80        lda screenColors        jsr l5BB9        lda #$a0        sta dispBufferOn        lda #$11        sta r1L        lda #$48        sta r1H        jsr l52E6        lda #$00        sta iconSelFlag        lda #$54        sta r0H        lda #$44        sta r0L        jsr DoIcons        lda #$bf        sta mouseOn        jsr l56EF        lda $0301        sta l5D13        lda $0300l5284:  sta l5D12        lda #$58        sta $0301        lda #$88        sta $0300        lda #$00        sta l5D10        lda #$55        sta keyVector+1        lda #$d6        sta keyVector        lda l544B        sta mouseTop        clc         adc #$50        sta mouseBottom        lda l5CDB        sta mouseLeft        sta mouseRight        lda l5CDC        sta $84BB        sta $84BD        lda #$50        clc         adc mouseRight        sta mouseRight        lda #$00        adc $84BD        sta $84BD        rts;**********************************************l52D0:  .byte $00         .byte $30, $11;bmi $52E4        .byte $48 ;pha         .byte $0a ;asl a        .byte $50 ;bvc l5284        ;.byte $13         ;eor $018D,x        ;.byte $03 ;**********************************************l52D6:  lda l5D13sta $0301lda l5D12        sta $0300        jsr RstrAppl        rts;**********************************************l52E6:  lda r1L        sta l544A        sta l5CDB        lda r1H        sta l544B        clc         adc #$22        sta l5447        lda #$00        clc         rol l5CDB        rol a        rol l5CDB        rol a        rol l5CDB        rol a        sta l5CDC        sta l5446        lda l5CDB        sta l5445        lda #$3c        clc         adc l5445        sta l5445        bcc l5322        inc l5446l5322:  rts;********************************************** l5323:  jsr l534F        jsr $BDDD        jsr l535D        jsr l5895        jsr l5857        jsr l5399        bit l5D10        bmi l5340        jsr l538E        jmp l5346l5340:  jsr l56EF        jsr l53A7l5346:  jsr l583D        jsr l5865        jmp l588El534F:  ldx #$0b        lda #$00l5353:  sta l5CED,x        dex         bpl l5353        sta l5CE8        rts;**********************************************l535D:  ldx #$00l535F:  lda $0100,x        beq l538D        cmp #$45        bne l536C        cpx #$08        bpl l5381l536C:  sta l5CED,x        inx         cpx #$0b        bne l535Fl5374:  lda $0100,x        beq l538D        cmp #$45        beq l5381        inx         jmp l5374l5381:  ldy #$00l5383:  sta l5CF4,y        inx         iny         lda $0100,x        bne l5383l538D:  rts;********************************************** l538E:  lda #$5c        sta r0H        lda #$ed        sta r0L        jmp l53A1l5399:  lda #$5c        sta r0H        lda #$f9        sta r0Ll53A1:  jsr l53B8        jmp PutStringl53A7:  lda #$5d        sta r0H        lda #$05        sta r0L        jsr l53A1        lda #$00        sta l5D10        rts;**********************************************l53B8:  jsr l53DA        lda #$41        sec         sbc r1H        sta r1H        lda l5CDB        clc         adc r1H        sta r11L        lda l5CDC        adc #$00        sta r11H        lda l544B        clc         adc #$11        sta r1H        rts ;**********************************************l53DA:  lda #$00        sta r1L        sta r1Hl53E0:  ldy r1L        lda (r0L),y        beq l53F3        jsr GetCharWidth        clc         adc r1H        sta r1H        inc r1L        jmp l53E0l53F3:  rts;********************************************** l53F4:  lda r2L        sec         sbc #$0a        sta r2H        sec         sbc #$0a        sta r2L        sec         lda r1L        sbc #$0a        sta r1L        lda r1H        sbc #$00        sta r1H        lda r1L        sta r4L        sta r3L        lda r1H        sta r4H        sta r3H        sec         lda r3L        sbc #$0a        sta r3L        lda r3H        sbc #$00        sta r3H        jsr InvertRectan        jsr l5437        lda r1H        sta r4H        lda r1L        sta r4L        jmp InvertRectanl5437:  ldx #$24l5439:  ldy #$00l543B:  lda (r0L,x)        iny         bne l543B        dex         bne l5439        rts;**********************************************l5444:  .byte $01l5445:  .byte $C4l5446:  .byte $00 l5447:  .byte $00         .byte $9c         cli l544A:  .byte $00 l544B:  .byte $00         asl a        .byte $50, $50;bvc $549F        .byte $54         jsr MouseUp        lda #$54        sta r0H        lda #$e3        sta r0L        lda l544A        sta r1L        lda #$00        asl r1L        rol a        asl r1L        rol a        asl r1L        rol a        sta r1H        clc         lda #$0e        adc r1L        sta r1L        bcc l5478        inc r1Hl5478:  lda l544B        clc         adc #$1c        sta r2L       jmp l5483l5483:  jsr l54D7        bcs l549D        ldx #$03l548A:  jsr l54D7        bcs l549E        clc         lda #$19        adc r0L        sta r0L        bcc l549A        inc r0Hl549A:  dex         bpl l548Al549D:  rts l549E:  jsr l54BF        bcs l54B8        ldx #$04l54A5:  jsr l54BF        bcs l54B9        clc         lda #$05        adc r0L        sta r0L        bcc l54B5        inc r0Hl54B5:  dex         bpl l54A5l54B8:  rts l54B9:  jsr l53F4        .byte $6C, $02, $00;jmp ($0002);**********************************************l54BF:  lda r1H        cmp mouseXPos+1        bne l54C9        lda r1L        cmp mouseXPosl54C9:  php         clc         lda #$0a        adc r1L        sta r1L        bcc l54D5        inc r1Hl54D5:  plp         rts;**********************************************l54D7:  lda r2L        cmp mouseYPos        php         clc         adc #$0a        sta r2L        plp         rts;**********************************************        lda #$37        jmp l5576        lda #$38        jmp l5576        lda #$39        jmp l5576        lda #$08        jmp l5705        lda #$00        jmp l52D6        lda #$34        jmp l5576        lda #$35        jmp l5576        lda #$36        jmp l5576        lda #$10        jmp l5548        lda #$00        jmp l56EF        lda #$31        jmp l5576        lda #$32        jmp l5576        lda #$33        jmp l5576        lda #$02        jmp l5705        lda #$00        jmp l56F7        lda #$2e        jmp l555F        lda #$30        jmp l5570        lda #$01        jmp l5705        lda #$04        jmp l5705        lda #$45        jmp l555F        rts l5548:  ldx l5CE8        beq l555A        dex         lda l5CED,x        cmp #$45        beq l555A        lda #$10        jmp l5705l555A:  lda #$2d        jmp l5576l555F:  ldx l5CE8        beq l556Cl5564:  cmp l5CED,x        beq l556F        dex         bpl l5564l556C:  jmp l5576l556F:  rts l5570:  ldx l5CE8        bne l5576        rts;**********************************************l5576:  ldx l5CE8        bmi l55B0        bne l5585        pha         jsr l5399        jsr l534F        pla l5585:  sta r2L        ldx l5CE8        dex         dex         lda l5CED,x        cmp #$2d        bne l5597        dex         lda l5CED,xl5597:  cmp #$45        beq l55B3l559B:  lda r2L        ldx l5CE8        sta l5CED,x        inx         stx l5CE8        cpx #$0b        bmi l55B0l55AB:  lda #$ff        sta l5CE8l55B0:  jmp l538El55B3:  ldx l5CE8        dex         lda #$2d        cmp l5CED,x        beq l559B        lda #$33        cmp l5CED,x        bmi l55B0        bne l55CD        lda #$37        cmp r2L        bmi l55B0l55CD:  inx         lda r2L        sta l5CED,x        jmp l55AB        lda keyData        cmp #$31        bmi l55EC        cmp #$3a        bpl l55EC        pha         sec         sbc #$30        jsr l568E        pla         jmp l5576l55EC:  cmp #$30        bne l55FA        pha         lda #$00        jsr l568E        pla         jmp l5570l55FA:  cmp #$2b        bne l5608        lda #$0b        jsr l568E        lda #$08        jmp l5705l5608:  cmp #$51        bne l5614        lda #$11        jsr l568E        jmp l52D6l5614:  cmp #$2d        bne l5622        lda #$0c        jsr l568E        lda #$10        jmp l5548l5622:  cmp #$63        bne l562E        lda #$12        jsr l568E        jmp l56EFl562E:  cmp #$2a        bne l563C        lda #$0d        jsr l568E        lda #$02        jmp l5705l563C:  cmp #$1d        bne l564A        pha         lda #$13        jsr l568E        pla         jmp l56F7l564A:  cmp #$65        beq l5652        cmp #$45        bne l565Cl5652:  lda #$10        jsr l568E        lda #$45        jmp l555Fl565C:  cmp #$2e        bne l566A        pha         lda #$0a        jsr l568E        pla         jmp l555Fl566A:  cmp #$3d        bne l5678        lda #$0f        jsr l568E        lda #$01        jmp l5705l5678:  cmp #$2f        bne l5686        lda #$0e        jsr l568E        lda #$04        jmp l5705l5686:  cmp #$e3        bne l568D        jmp l5ACBl568D:  rts;********************************************** l568E:  sta r2L        asl a        asl a        sec         sbc r2L        tax         clc         lda l544B        adc l56B3,x        sta r2L        clc         lda l5CDB        adc l56B3+1,x        sta r1L        lda l5CDC        adc l56B3+2,x        sta r1H        jmp l53F4;**********************************************l56B3:        .byte $4E, $2C, $00, $44, $22, $00, $44, $2C		.byte $00, $44, $36, $00, $3a, $22, $00, $3a         .byte $2C, $00, $3a, $36, $00, $30, $22, $00         .byte $30, $2C, $00, $30, $36, $00, $4E, $22		.byte $00, $30, $40, $00, $3a, $40, $00, $44         .byte $40, $00, $4E, $40, $00, $4E, $36, $00        .byte $4E, $4A, $00, $30, $4A, $00, $3a, $4A        .byte $00, $44, $4A, $00;********************************************** l56EF:  lda #$00        sta l5CDD        sta l5D11l56F7:  jsr l5399        jsr l534F        lda #$30        sta l5CED        jmp l538El5705:  cmp #$10        beq l5713        bit l5D11        bmi l5713        ldx l5CE8        beq l5747l5713:  sei         sta r2Hl5716:  lda #$00        sta l5D11        jsr l583D        jsr l5865        jsr l588E        .byte $20, $73, $00;jsr $0073        jsr $BCF3        bit l5CDD        bmi l573D        bvs l5737        jsr l5748        jmp l5740l5737:  jsr l575C        jmp l5740l573D:  jsr l5789l5740:  jsr l5895        jsr l5857        cli l5747:  rts;********************************************** l5748:  lda r2H        lsr a        bcs l5759        ldx #$de        ldy #$5c        jsr $BBD4        lda #$40        jmp l582Cl5759:  jmp l581E;**********************************************l575C:  lda l5CDD        lsr a        bcs l5788        and #$03        beq l5776l5766:  jsr l57AA        lda r2H        lsr a        bcc l5771        jmp l581El5771:  lda #$40        jmp l582Cl5776:  lda r2H        and #$06        beq l5766        ldx #$e3        ldy #$5c        jsr $BBD4        lda #$c0        jsr l582Cl5788:  rts;********************************************** l5789:  lda r2H        and #$06        beq l5797        jsr l57B9        lda #$c0        jmp l582Cl5797:  lda r2H        pha         jsr l57B9        lda #$e3        ldy #$5c        jsr $BBA2        pla         sta r2H        jmp l575Cl57AA:  lda #$de        sta r3L        sta r4L        lda #$5c        sta r3H        sta r4H        jmp l57C8;**********************************************l57B9:  lda #$e3        sta r3L        sta r4L        lda #$5c        sta r3H        sta r4H        jmp l57C8l57C8:  lda r3L        ldy r3H        jsr $BA8C        lda l5CDD        lsr a        bcc l57DA        lda #$01        jmp l5803l57DA:  lsr a        bcc l57E5        jsr $BA2B        lda #$02        jmp l5803l57E5:  lsr a        bcc l57F0        jsr $BB12        lda #$04        jmp l5803l57F0:  lsr a        bcc l57FB        jsr $B86A        lda #$08        jmp l5803l57FB:  lsr a        bcc l581D        jsr $B853        lda #$10l5803:  eor l5CDD        sta l5CDD        lda #$00        sta a2L        ldx r4L        ldy r4H        jsr $BBD4        lda r2H        pha         jsr l5323        pla         sta r2Hl581D:  rts;********************************************** l581E:  lda #$00        sta l5CDD        sta l5CE8        lda #$ff        sta l5D11        rts;**********************************************l582C:  ora r2H        sta r2L        lda l5CDD        and #$3f        ora r2L        sta l5CDD        jmp l534F;**********************************************l583D:  ldx #$e9l583F:  dex         beq l584A        lda r13L,x        sta l5EFF+1,x        jmp l583Fl584A:  ldx #$e9        lda #$00l584E:  dex         beq l5856        sta r13L,x        jmp l584El5856:  rts;********************************************** l5857:  ldx #$e9l5859:  dex         beq l5864        lda l5EFF+1,x        sta r13L,x        jmp l5859l5864:  rts;********************************************** l5865:  ldx #$17l5867:  lda l5870,x        sta a3H,x        dex         bpl l5867        rts;**********************************************; no entry?l5870:  inc a7L        bne l5876        inc a7Hl5876:  lda l5CEC        cmp #$3a        bcs l5887        cmp #$20        beq l5870        sec         sbc #$30        sec         sbc #$d0l5887:  rts ;**********************************************        lda #$ff        sta l5D10        rts;**********************************************l588E:  lda $01        ora #$02        sta $01        rts ;**********************************************l5895:  lda $01        and #$fd        sta $01        rts;********************************************** l589C:   asl a        .byte $ff         sta ($BF,x)        php         .byte $ff         .byte $82         sbc $08DF,x        .byte $ff         .byte $82         .byte $fb         .byte $ef         .byte $08          .byte $ff l58AC:  .byte $02 		.byte $f7 		.byte $08  		.byte $ff 		sta ($EF,x)		asl a		.byte $ff 		sta ($F8,x)l58B6:  .byte $08, $00, $82, $1f, $fb l58BB:  .byte $08, $ff, $82, $df, $fa, $fa, $02, $08         .byte $00, $82, $5f, $fa, $08  l58C8:  .byte $00, $82, $5f, $fa, $08, $00, $82, $5f		.byte $fa, $08, $00, $82, $5f l58D5:  .byte $fa l58D6:  php		.byte $00, $82, $5F, $FA, $08, $00, $82, $5F		.byte $fa, $08, $00, $82l58E3:  .byte $5F, $FA, $08, $00, $82, $5F, $FB		.byte $08, $ff, $82, $DF, $FA		inc r0Ll58F1:  php		.byte $00, $82, $5F, $FB, $08, $55, $82, $5F		.byte $FAl58FB:  php         .byte $00, $DB, $5f, $FB, $55, $ff, $7f, $df		.byte $f7, $fd, $ff, $55, $5f, $fa, $02, $01		.byte $80, $60, $18, $06, $01, $80, $5f, $fb		.byte $56, $fd, $9e, $67, $98, $c6, $fd, $d5		.byte $5f, $fa, $02, $0d, $b3, $6c, $d8, $c6		.byte $fd, $80, $5f, $fb, $59, $19, $9el592B:  ror $DB        inc a1L,x        cmp $5F,x        .byte $fa         .byte $02         ora $63B3,y        cld         dec a1L        .byte $80         .byte $5f         .byte $fb l593C:  lsr msePicPtr,x        .byte $b3         jmp ($C6D8)        sbc $5FD5,x        .byte $fa, $02         and ($9E),y        .byte $67         tya         asl a1L        .byte $80, $5f, $fb         lsr $01,xl5952:  .byte $80         rts         clc         asl $01        cmp $5F,x        .byte $db, $fa         ora (a1H,x)        .byte $ff, $bf, $ef, $fb         inc $5F80,xl5964:  .byte $fb         eor $FF,x        .byte $7f, $df, $f7         sbc $55FF,x        .byte $5f, $fa, $02         ora ($80,x)        rts l5973:  clc         asl $01        .byte $80, $5f, $fb         lsr pressFlag,x        .byte $bf, $67         tya         asl a6H        cmp $5F,x        .byte $fa, $02 l5984:  adc $6CB0,y        cld         asl $CD        .byte $80, $5f, $fb         lsr $D9,x        ldx $1B6F,y        inc $C1,x        cmp $5F,x        .byte $fa, $02         sbc $6D83,x        tya         asl $C1l599E:  .byte $80, $5f, $fb         lsr r11H,x        .byte $b3         jmp ($06D8)        cmp $5FD5        .byte $fa         .byte $02         and $679E,x        tya         asl a6H        .byte $80 l59B3:  .byte $5f, $fb, $db         lsr $01,x        .byte $80         rts         clc         asl $01        cmp $5F,x        .byte $fa, $03         inc $BFFF,x        .byte $ef l59C5:  .byte $fb         inc $5F80,x        .byte $fb         eor $FF,x        .byte $7f, $df, $f7         sbc $55FF,x        .byte $5f, $fa, $02 l59D5:  ora ($80,x)        rts         clc         asl $01        .byte $80, $5f, $fb         lsr r7H,x        .byte $9e, $67         txs         asl $4D,x        cmp $5F,xl59E7:  .byte $fa, $02         and ($B3),y        jmp ($26D9)l59EE:        lda #$80        .byte $5f, $fb         lsr a2H,x        .byte $83         adc ($98,x)        dec $8D        cmp $5F,x        .byte $fa, $02         and ($86),y        rts         cld         dec $89        .byte $80, $5f, $fb         lsr msePicPtr,x        tya         jmp ($26D9)        lda #$d5        .byte $5f, $fa, $02, $db         adc $67BF,y        txs         asl $4D,x        .byte $80, $5f, $fb         lsr $01,x        .byte $80         rts         clc l5A20:  asl $01        cmp $5F,x        .byte $fa         ora (a1H,x)        .byte $ff, $bf, $ef, $fb         inc $5F80,x        .byte $fb         eor $FF,x        .byte $7f, $df, $f7         sbc $55FF,x        .byte $5f, $fa, $02         ora ($80,x)        rts         clc         asl $01        .byte $80, $5f, $fb         lsr $01,x        .byte $9f         rts         clc         dec a1L        cmp $5F,xl5A4C:   .byte $fa         .byte $02         ora ($A3,x)        .byte $67         tya         asl $CD        .byte $80, $5f, $fb         lsr msePicPtr,x        lda $60        .byte $1b         inc $E1,x        cmp $5F,x        .byte $fa, $02         and ($A9),y        .byte $67         tya         asl $E1        .byte $80, $5f, $fb         lsr $01,x        bcs l5A20        rts         clc         dec $CD        cmp $5F,x        .byte $fa         .byte $02         ora ($BE,x)        rts         clc         asl a1L        .byte $80, $5f, $fb         lsr $01,x        .byte $80         rts         clc         asl $01        cmp $5F,x        .byte $fa, $03         inc $BFFF,x        .byte $ef, $fb         inc $5F80,x        .byte $fb         eor $FF,x        .byte $7f, $df, $f7         sbc $55FF,x        .byte $5f, $fa         php        .byte $00, $82, $5f, $fb         php         eor $82,x        .byte $5f, $fb         php         .byte $ff, $82, $df         sed         php         .byte $00         sta (r14H,x)        asl a        .byte $ff         sta ($F7,x)        php         .byte $ff, $02, $ef         php         .byte $ff, $82, $f7, $df         php         .byte $ff, $82, $fb, $bf         php         .byte $ff         sta (a1L,x)        asl a        .byte $ff         asl a        .byte $ff ;**********************************************l5ACB:  jsr l5B04        tya         beq l5B03        sta l5D14        clc         adc #$02        clc         adc #$14        sta l5B5C        lda #$00        sta l5D15        adc #$5d        sta l5B5C+1        lda l5B14        sta r0H        lda l5B13        sta r0L        jsr DeleteFile        lda #$5b        sta r9H        lda #$13        sta r9L        lda #$00        sta r10L        jsr SaveFilel5B03:  rts;********************************************** l5B04:  ldy #$00l5B06:  lda l5CED,y        sta l5D16,y        beq l5B12        iny         clv         bvc l5B06l5B12:  rts ;**********************************************l5B13:  .byte $74 l5B14:  .byte $5b         .byte $03         ora $BF,x        .byte $ff         .byte $ff         .byte $ff         .byte $80         rti         ora ($80,x)        rts         ora ($80,x)        rts         ora ($80,x)        rts         ora $5080        and $80,x        .byte $50, $d9 ;bvc l5B06        .byte $80         .byte $53         and ($80,x)        .byte $5c         cmp ($80,x)        eor $8701,y        dec $9F01        iny         ora ($B8,x)l5B3D:  sed         ora ($B1,x)        .byte $fc         ora ($BF,x)        .byte $6E, $01, $9C  ;ror $9C01        ror $01        .byte $80         ror $01        .byte $80         .byte $6C, $01, $80  ;jmp ($8001)        sec         ora ($80,x)        .byte $00 l5B53:  .byte $01, $ff, $ff, $ff, $83, $04, $00, $14, $5Dl5B5C:  .byte $00, $00, $00, $00 l5B60:  .byte $54         adc a6L        .byte $74         jsr $6353        .byte $72         adc (a2L,x)        jsr $5620        and (currentMode),y        and ($00),y        .byte $00, $00, $00, $54         adc a6L        .byte $74         jsr $5320        .byte $63         .byte $72         adc (a2L,x)        .byte $00;**********************************************l5B80:  lda r6L        sta l5CCA        beq l5B98        ldy #$04        lda (r5L),y        clc         adc #$01        sta (r5L),y        iny         lda (r5L),y        clc         adc #$08        sta (r5L),yl5B98:  sec         lda r5L        sbc #$d0        sta r7L        lda r5H        sbc #$52        sta r7H        ldx r7L        stx $5CCB        jsr l5CCC        jsr l5BFD        lda l5CCA        beq l5BB8        jsr l5C24l5BB8:  rts;********************************************** l5BB9:  sta r7L        jsr l5CA3l5BBE:  jsr l5C84l5BC1:  ldy #$00        lda r7L        sta (r5L),y        inc r5L        bne l5BCD        inc r5Hl5BCD:  dec r4L        bne l5BC1        inc r2H        dec r3H        bne l5BBE        lda l5CCA        beq l5BFC        lda l5CC5        sta r5H        lda l5CC4        sta r5L        lda l5CC7        sta r7H        lda l5CC6        sta r7L        ldy #$00        lda l5CC8        sta (r5L),y        lda l5CC9        sta (r7L),yl5BFC:  rts;********************************************** l5BFD:  lda #$00        sta r7H        lda r2L        sta r7L        ldx #$10        lda r2H        lsr a        lsr a        lsr a        sta l5CC3        tay         jsr l5C73        lda #$00        clc         adc r7L        sta l5CBF        lda #$8c        adc r7H        sta l5CC0        rts         rts;**********************************************l5C24:  jsr l5CA3        lda #$00        sta r7H        lda r3L        sta r7L        dec r7L        lda l5CBF        clc         adc r7L        sta r7L        lda l5CC0        adc r7H        sta r7H        ldy #$00        lda (r7L),y        sta l5CC8        lda r7H        sta l5CC5        lda r7L        sta l5CC4        lda l5CC0        sta r7H        lda l5CBF        sta r7L        ldx #$10        ldy r3H        dey         jsr l5C73        lda (r7L),y        sta l5CC9        lda r7H        sta l5CC7        lda r7L        sta l5CC6        rts;**********************************************l5C73:  beq l5C83l5C75:  lda #$28        clc         adc $00,x        sta $00,x        bcc l5C80        inc $01,xl5C80:  dey         bne l5C75l5C83:  rts;********************************************** l5C84:  lda #$8c        sta r5H        lda #$00        sta r5L        ldx #$0c        ldy r2H        jsr l5C73        lda r2L        clc         adc r5L        sta r5L        bcc l5C9E        inc r5Hl5C9E:  lda r3L        sta r4L        rts;**********************************************l5CA3:  ldx l5CCB        jsr l5CCC        lda l5CC2        sta r1H        lda $5CC1        sta r1L        lda l5CC3        sta r2H        lsr r3H        lsr r3H        lsr r3H        rts ;**********************************************l5CBF:  .byte $00 l5CC0:  .byte $8Cl5CC1:  .byte $00l5CC2:  .byte $00l5CC3:  .byte $00 l5CC4:  .byte $00 l5CC5:  .byte $00 l5CC6:  .byte $00 l5CC7:  .byte $00 l5CC8:  .byte $00 l5CC9:  .byte $00 l5CCA:  .byte $00 l5CCB:  .byte $00 ;**********************************************l5CCC:  ldy #$00l5CCE:  lda $52D0,x.byte $99, $04, $00   ; sta $0004,y (geoprogrammer doesnt like)        inx         iny         cpy #$06        bne l5CCE        rts ;**********************************************l5CDB:  .byte $00 l5CDC:  .byte $00 l5CDD:  .byte $00         .byte $00, $00, $00, $00, $00, $00, $00, $00         .byte $00, $00 l5CE8:  .byte $00, $00, $00, $00 l5CEC:  .byte $00 l5CED:  .byte $00, $00, $00, $00, $00, $00, $00l5CF4:  .byte $00, $00, $00, $00, $00l5CF9:  jsr $2020        jsr $2020        jsr $2020        .byte $20, $20, $00        jsr $4520        .byte $52, $52, $4f, $52         jsr $2020        .byte $00 l5D10:  .byte $00 l5D11:  .byte $00 l5D12:  .byte $00 l5D13:  .byte $00 l5D14:  .byte $00 l5D15:  .byte $00l5D16:  .byte $00, $00, $00, $00, $00, $00, $00         .byte $00, $00, $00, $00;**********************************************; not sure how this gets calledl5D21:  txa         bne l5D45        ldy #$01        lda (r5L),y        sta r1L        iny         lda (r5L),y        sta r1H        jsr l5DE9        txa         bne l5D45        ldy #$13        lda (r5L),y        beq l5D45        sta r1L        iny         lda (r5L),y        sta r1H        jsr l5DE9l5D45:  cpx #$00        bne l5D54        ldy #$1c        lda r9L        sta (r5L),y        iny         lda r9H        sta (r5L),yl5D54:  rts         lda $0538        cmp #$03        beq l5D5F        ldx #$00        rts l5D5F:  ldy #$01        lda (r5L),y        sta r1L        iny         lda (r5L),y        sec         sbc #$01        sta r1H        ldy #$1c        lda (r5L),y        sta r12L        iny         lda (r5L),y        sta r12Hl5D78:  ldx #$00        lda r12H        ora r12L        beq l5DA3        inc r1H        lda r1H        cmp #$28        bcc l5D8E        lda #$00        sta r1H        inc r1Ll5D8E:  ldx #$02        lda r1L        beq l5DA3        cmp #$51        bcs l5DA3        jsr $3601        ldx #$1a        jsr Ddec        clv         bvc l5D78l5DA3:  rts;********************************************** ; no entry?        ldx #$00        ldy #$15        lda (r5L),y        cmp #$01        bne l5DE8        ldy #$01        lda (r5L),y        sta r1L        iny         lda (r5L),y        sta r1H        lda #$81        sta r4H        lda #$00        sta r4L        jsr GetBlock        txa         bne l5DE8        ldy #$02l5DC9:  tya         pha         lda fileHeader,y        sta r1L        iny         lda fileHeader,y        sta r1H        ldx #$00        lda r1L        beq l5DDF        jsr l5DE9l5DDF:  pla         tay         txa         bne l5DE8        iny         iny         bne l5DC9l5DE8:  rts;********************************************** l5DE9:  jsr EnterTurbo        txa         bne l5E27        jsr InitForIOl5DF2:  lda #$80        sta r4H        lda #$00        sta r4L        lda $0538        cmp #$02        bcc l5E07        jsr ReadLink        clv         bvc l5E0Al5E07:  jsr ReadBlockl5E0A:  txa         bne l5E27        inc r9L        bne l5E13        inc r9Hl5E13:  jsr $3601        txa         bne l5E27        lda $8001        sta r1H        lda diskBlkBuf        sta r1L        bne l5DF2        ldx #$00l5E27:  jmp DoneWithIO        .byte $00, $00, $00, $00, $00, $00, $00, $00         .byte $00, $00, $00, $00, $00, $00, $00, $00         .byte $00, $00, $00, $00, $00, $00, $00, $00         .byte $00, $00, $00, $00, $00, $00, $00, $00;**********************************************; not sure how this gets called;        ldy curDrive        lda $8486,y        and #$0f        pha         cmp #$01        beq l5E59        bcs l5E64l5E59:  lda #$23        sta r1L        lda #$00        sta r1H        jsr $1D92l5E64:  ldy #$00        lda #$4e        sta $5E2A,y        iny         lda #$30        sta $5E2A,y        iny         lda #$3a        sta $5E2A,y        ldy #$00l5E79:  lda (r0L),y        sta $5E2D,y        beq l5E83        iny         bne l5E79l5E83:  lda #$2c        sta $5E2D,y        iny         lda minutes        and #$0f        adc #$41        sta $5E2D,y        iny         lda seconds        and #$0f        adc #$41        sta $5E2D,y        iny         lda #$ff        sta $5E2D,y        jsr PurgeTurbo        jsr InitForIO        pla         sta r4L        cmp #$02        bne l5EC4        lda $0539        clc         adc #$2f        sta $5EF5        ldy #$5e        lda #$f1        jsr l5EFF        txa         bne l5EE1l5EC4:  lda r4L        cmp #$03        bcs l5ED4        ldy #$5e        lda #$f7        jsr l5EFF        txa         bne l5EE1l5ED4:  ldy #$5e        lda #$2a        jsr l5EFF        txa         bne l5EE1        jsr l5F42l5EE1:  jsr DoneWithIO        txa         bne l5EF0        jsr NewDisk        txa         bne l5EF0        jsr SetGEOSDiskl5EF0:  rts         eor mouseOn,x        rol $314D,x        .byte $ff         eor $572D        .byte $22         .byte $00         ora ($00,x)        .byte $ff;**********************************************; does something with the drives.  saves data?;l5EFF:  sty r0H        sta r0L        lda #$00        sta STATUS        lda curDrive        jsr cmdListen        bit STATUS        bmi l5F3C        lda #$ff        jsr sendSecL        bit STATUS        bmi l5F3C        ldy #$00l5F1C:  lda (r0L),y        cmp #$ff        beq l5F28        jsr outByte        iny         bne l5F1Cl5F28:  jsr cmdUnList        lda curDrive        jsr cmdListen        lda #$ef        jsr sendSecL        jsr cmdUnList        ldx #$00        rtsl5F3C:  jsr cmdUnList        ldx #$0d        rts;**********************************************l5F42:  lda #$00        sta STATUS        lda curDrive        jsr cmdTalk        bit STATUS        bmi l5F85        lda #$ff        jsr sendSecT        bit STATUS        bmi l5F85        jsr inpByte        and #$0f        asl a        asl a        asl a        asl a        sta l5F8B        jsr inpByte        and #$0f        ora $5F8B        sta l5F8B        jsr cmdUnTalk        lda curDrive        jsr cmdListen        lda #$ef        jsr sendSecL        jsr cmdUnList        ldx $5F8B        rts l5F85:  jsr cmdUnTalk        ldx #$0d        rts;**********************************************l5F8B:  .byte $00         clc         lsr $6F        .byte $72         adc $7461        jsr $6F62        .byte $74         pla         jsr $6973        .byte $64         adc a3H        jsr $666F        jsr $6964        .byte $73         .byte $6b         .byte $3f         jsr $4220        adc $00        .byte $63         adc (a3L,x)        adc $66        adc $6C,x        bit $6120        .byte $73         jsr $6874        adc #$73        jsr $6977        jmp ($206C)        .byte $64         adc a3H        .byte $74         .byte $72         .byte $6f         adc $6120,y        ror $0079        .byte $64         adc (a4L,x)        adc (r15L,x)        .byte $6f         ror $7420        pla         adc r15L        ror $6C        adc #$70        jsr $6973        .byte $64         adc r15L        .byte $6f         ror r15L        .byte $74         pla         adc r15L        .byte $64         adc #$73        .byte $6b         rol $1800        .byte $54         pla         adc a3L        adc r15L        adc #$73        jsr $7563        .byte $72         .byte $72         adc $00.ramsectDAEnd: